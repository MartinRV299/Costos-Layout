class a{static setup(){$(".monetario").mask("000,000,000.00",{reverse:!0}),$(".porcentaje").mask("09.09"),a.comisionMonto=0,a.formulario=$("#formularioNominas"),a.cancelar=$("#formularioCancelarNominas"),a.iva=$("#nominasIva"),a.tipoSindicato=$("#tipoSindicato"),a.facturaDevengada=$("#facturaDevengada"),a.styleFacturaDevengada=$("#styleFacturaDevengada"),a.retencionIva6=$("#retencionIva"),a.calcularRetencionIva=$("#calcularRetencionIva"),a.tipoSindicato.html(""),a.cargarNumeroNomina=$("#cargarNumeroNomina"),a.sinFactura=$('select[name="nominasEmpresaFactura"]'),a.devengada=$("#devengada"),a.subtotal=$("#nominasSubtotal"),a.total=$("#nominasTotal"),a.retencionIsn=$("#retencionIsn"),a.checkRetencionIsn=$("#checkCalcularIsn"),a.impuestoEstatal=$("#impuestoEstatal"),a.botonMostrarData=$(".nominasMostrarData"),a.consecutivoNomina=$("#consecutivoNomina"),a.campoActualizar=$(".actualizar"),a.botonFormularioActualizarNominas=$("#botonFormularioActualizarNominas"),a.botonFormularioGuardarNominas=$("#botonFormularioGuardarNominas"),a.formularioActualizarNominas=$("#formularioNominasActualizar"),a.recargarNominas=$("#recargarNominas"),a.totalTexto=$("#totalRegistrosNominas"),a.botonActualizarNominas=$("#actualizarNominas"),a.nominasComision=$("#nominasComision"),a.paginador=$(".nominas"),a.mostrarPaginador=$(".paginadorNominas"),a.filtroCliente=$("#filtroNombreCliente"),a.filtroFacturado=$("#filtroMontoFacturado"),a.filtroObservaciones=$("#filtroObservaciones"),a.filtroPago=$("#filtroPago"),a.filtroNumeroNomina=$("#filtroNumeroNomina"),a.filtroNominista=$("#filtroNombreNominista"),a.filtroAutorizacion=$("#filtroAutorizacion"),a.facturado="",a.liberado="",a.formularioActualizarFinanzas=$("#formularioFinanzasActualizar"),a.botonFormularioActualizarFinanzas=$("#botonFormularioActualizarFinanzas"),a.botonFormularioGuardarFinanzas=$("#botonFormularioGuardarFinanzas"),a.financiada=$("#financiada"),a.fondeoImss=$("#fondeoImss"),a.fondeoAsimilado=$("#fondeoAsimilados"),a.cargarNominas=$("#cargarRegistrosNominas"),a.formularioCargarNominasManual=$("#formularioCargarNominas"),a.modalData=$("#dataNominas"),a.marcadorPendientes=$("#cargarMarcadoresPendientes"),a.marcadorLiberadas=$("#cargarMarcadoresLiberados"),a.marcadorCanceladas=$("#cargarMarcadoresCancelados"),a.marcadorPendientes2=$("#cargarMarcadoresPendientes2"),a.marcadorPagadas=$("#cargarMarcadoresPagadas"),a.marcadorCanceladas2=$("#cargarMarcadoresCancelados2"),a.esquemas=$("#tipoEsquema"),a.esquemasAjax=$("#tipoEsquemaAjax"),a.info=$(".info"),a.recargarFinanzasComentarios=$("#actualizarFinanzasComentarios"),a.recargarTesoreriaComentarios=$("#actualizarTesoreriaComentarios"),a.formularioActualizarTesoreria=$("#formularioTesoreriaActualizar"),a.botonFormularioActualizarTesoreria=$("#botonFormularioActualizarTesoreria"),a.botonFormularioGuardarTesoreria=$("#botonFormularioGuardarTesoreria"),a.campoActualizar3=$(".actualizar3"),a.documentosNominas=$("#documentosNominas"),a.botonDocumentosNominas=$("#archivosNominas"),a.documentosNominas2=$("#documentosNominas2"),a.botonDocumentosNominas2=$("#archivosNominas2"),a.totalArchivos=0,a.totalArchivosAll=0,a.files=[],a.totalArchivos2=0,a.files2=[],a.totalArchivosAll2=0,a.fileSizeLimit=25,a.botonNominaPrimaria=$("#botonGuardarNominaPrimaria"),a.labelAdjuntos=$("#labelAdjuntos"),a.adjuntosContador=$(".adjuntosContador"),a.areaAdjuntosLoad=$("#areaAdjuntosLoad"),a.ocultarLienzoAdjuntos=$("#ocultarLienzoAdjuntos"),a.ocultarLienzoAdjuntos2=$("#ocultarLienzoAdjuntos2"),a.nominista=$("#credencialesUsuario").attr("value"),a.adjuntarArchivosMasivos=$("#cargarARchivosAdjuntosMasivos"),a.adjuntarArchivosMasivosRecibos=$("#adjuntarArchivosMasivosRecibos"),a.adjuntarArchivosMasivosFinanzas=$("#cargarArchivosAdjuntosMasivosFinanzas"),a.adjuntarArchivosMasivosTesoreria=$("#cargarArchivosAdjuntosMasivosTesoreria"),a.totalAdjuntos=$("#totalAdjuntos"),a.totalAdjuntosPeso=$("#totalAdjuntosPeso"),a.totalAdjuntosPeso2=$("#totalAdjuntosPeso2"),a.totalAdjuntos2=$("#totalAdjuntos2"),a.botonArchivosAdjuntos=$(".botonArchivosAdjuntos"),a.modalArchivosAdjuntos=$("#modalArchivosAdjuntos"),a.dataArchivosAdjuntos=$("#dataArchivosAdjuntos"),a.labelArchivosAdjuntos=$("#labelArchivosAdjuntos"),a.nominasCliente=$('select[name="nominasCliente"]'),a.nominasTipoPago=$('select[name="nominasTipoPago"]'),a.nominasRegimen=$('select[name="nominasRegimen"]'),a.nominasComision=$('input[name="nominasComision"]'),a.nominasEmpresaFactura=$('select[name="nominasEmpresaFactura"]'),a.nominasSubtotal=$('input[name="nominasSubtotal"]'),a.nominasIva=$('input[name="nominasIva"]'),a.nominasTotal=$('input[name="nominasTotal"]'),a.nominasEmpresaImss=$('select[name="nominasEmpresaImss"]'),a.nominasTotalImss=$('input[name="nominasTotalImss"]'),a.nominasEmpresaAsimilados=$('select[name="nominasEmpresaAsimilados"]'),a.nominasTotalAsimilados=$('input[name="nominasTotalAsimilados"]'),a.nominasPeriodo=$('select[name="nominasPeriodo"]'),a.nominasNumeroPeriodo=$('input[name="nominasNumeroPeriodo"]'),a.nominasSocios=$('input[name="nominasSocios"]'),a.nominasDescuentosSys=$('input[name="nominasDescuentosSys"]'),a.nominasDescuentosAsesores=$('input[name="nominasDescuentosAsesores"]'),a.nominasDescuentosTerceros=$('input[name="nominasDescuentosTerceros"]'),a.retencionIva=$('input[name="retencionIva"]'),a.nominasIngreso=$('input[name="nominasIngreso"]'),a.nominasInfonavit=$('input[name="nominasInfonavit"]'),a.nominasFonacot=$('input[name="nominasFonacot"]'),a.nominasDonativo=$('input[name="nominasDonativo"]'),a.nominasPensionAlimenticia=$('input[name="nominasPensionAlimenticia"]'),a.nominasExcedenteCargas=$('input[name="nominasExcedenteCargas"]'),a.nominasCargaPatronal=$('input[name="nominasCargaPatronal"]'),a.nominasIsn=$('input[name="nominasIsn"]'),a.nominasComisionMonto=$('input[name="nominasComisionMonto"]'),a.nominasImssObrera=$('input[name="nominasImssObrera"]'),a.nominasCargaSocialImss=$('input[name="nominasCargaSocialImss"]'),a.nominasPrenominaImss=$('input[name="nominasPrenominaImss"]'),a.nominasIsrIsp=$('input[name="nominasIsrIsp"]'),a.nominasIsr142=$('input[name="nominasIsr142"]'),a.nominasCuotaSindical=$('input[name="nominasCuotaSindical"]'),a.nominasDespensa=$('input[name="nominasDespensa"]'),a.nominasCajaAhorro=$('input[name="nominasCajaAhorro"]'),a.nominasDescuentoImss=$('input[name="nominasDescuentoImss"]'),a.nominasApoyoSindical=$('input[name="nominasApoyoSindical"]'),a.nominasDescuentoComedor=$('input[name="nominasDescuentoComedor"]'),a.nominasHaberes=$('input[name="nominasHaberes"]'),a.nominasExcedenteSubsidio=$('input[name="nominasExcedenteSubsidio"]'),a.nominasPrestamosEmpleados=$('input[name="nominasPrestamosEmpleados"]'),a.nominasPrestamosAyudate=$('input[name="nominasPrestamosAyudate"]'),a.nominasOtros=$('input[name="nominasOtros"]'),a.nominasExcedenteIngreso=$('input[name="nominasExcedenteIngreso"]'),a.nominasExcedenteTerceros=$('input[name="nominasExcedenteTerceros"]'),a.nominasExcedenteIsr=$('input[name="nominasExcedenteIsr"]'),a.nominasExcedenteImss=$('input[name="nominasExcedenteImss"]'),a.nominasExcedenteGmm=$('input[name="nominasExcedenteGmm"]'),a.nominasExcedenteInfonavit=$('input[name="nominasExcedenteInfonavit"]'),a.nominasExcedenteFonacot=$('input[name="nominasExcedenteFonacot"]'),a.nominasExcedentePrestamos=$('input[name="nominasExcedentePrestamos"]'),a.nominasExcedentePensionAlimencia=$('input[name="nominasExcedentePensionAlimencia"]'),a.nominasExcedenteIngresosSinTimbrar=$('input[name="nominasExcedenteIngresosSinTimbrar"]'),a.nominasExcedenteClientes=$('input[name="nominasExcedenteClientes"]'),a.nominasExcedenteRecuperacion=$('input[name="nominasExcedenteRecuperacion"]'),a.nominasExcedenteComisionSocio=$('input[name="nominasExcedenteComisionSocio"]'),a.nominasExcedentePrenominaImss=$('input[name="nominasExcedentePrenominaImss"]'),a.nominasExcedentePrenominaGmm=$('input[name="nominasExcedentePrenominaGmm"]'),a.nominasExcedenteCajaAhorro=$('input[name="nominasExcedenteCajaAhorro"]'),a.nominasExcedenteOtros=$('input[name="nominasExcedenteOtros"]'),a.nominasComentarios=$('textarea[name="nominasComentarios"]'),a.numeroNominaOrigen=null,a.autorizarMasivo=$("#masterAutorizar"),a.eliminarMasivo=$("#masterEliminar"),a.retencionIva6Ajax=$("#retencionIva2"),a.retencionIsnAjax=$("#retencionIsn2"),a.checkRetencionIsnAjax=$("#checkCalcularIsn2"),a.impuestoEstatalAjax=$("#impuestoEstatal2"),a.campoRetencionObligatorioAjax=$(".campoRetencionObligatorio2"),a.calcularRetencionIvaAjax=$("#calcularRetencionIva2"),a.campoActualizar2=$(".actualizar2"),a.totalAjax=$("#nominasTotalAjax"),a.subtotalAjax=$("#nominasSubtotalAjax"),a.devengadaAjax=$("#devengadaAjax"),a.facturaDevengadaAjax=$("#facturaDevengada2"),a.styleFacturaDevengadaAjax=$("#styleFacturaDevengada2"),a.ivaAjax=$("#nominasIvaAjax"),a.comisionMontoAjax=0,a.nominasPensionAlimenticia2=$("#nominasPensionAlimenticia2"),a.nominasPrestamosEmpleados2=$("#nominasPrestamosEmpleados2"),a.nominasDescuentosSys2=$("#nominasDescuentosSys2"),a.nominasDescuentosTerceros2=$("#nominasDescuentosTerceros2"),a.nominasExcedentePensionAlimencia2=$("#nominasExcedentePensionAlimencia2"),a.nominasExcedenteClientes2=$("#nominasExcedenteClientes2"),a.nominasExcedenteOtros2=$("#nominasExcedenteOtros2"),a.nominasExcedenteIsr2=$("#nominasExcedenteIsr2"),a.nominasExcedenteImss2=$("#nominasExcedenteImss2"),a.nominasExcedenteGmm2=$("#nominasExcedenteGmm2"),a.nominasExcedenteInfonavit2=$("#nominasExcedenteInfonavit2"),a.nominasExcedenteFonacot2=$("#nominasExcedenteFonacot2"),a.nominasExcedentePrestamos2=$("#nominasExcedentePrestamos2"),a.nominasExcedenteRecuperacion2=$("#nominasExcedenteRecuperacion2"),a.nominasExcedenteComisionSocio2=$("#nominasExcedenteComisionSocio2"),a.nominasExcedentePrenominaImss2=$("#nominasExcedentePrenominaImss2"),a.nominasExcedentePrenominaGmm2=$("#nominasExcedentePrenominaGmm2"),a.nominasExcedenteCajaAhorro2=$("#nominasExcedenteCajaAhorro2"),a.nominasDescuentosAsesores2=$("#nominasDescuentosAsesores2")}static validacionCambioEsquemas(o){switch($(".asimilados-icono").css("display","none"),$(".asimilados-validacion").prop("required",!1),$(".mixto-icono").css("display","none"),$(".mixto-validacion").prop("required",!1),$(".sindicato-icono").css("display","none"),$(".sindicato-validacion").prop("required",!1),$(".sys-icono").css("display","none"),$(".sys-validacion").prop("required",!1),$(".tarjeta-icono").css("display","none"),$(".tarjeta-validacion").prop("required",!1),$(".prestamo-icono").css("display","none"),$(".prestamo-validacion").prop("required",!1),$(".especial-icono").css("display","none"),$(".especial-validacion").prop("required",!1),a.tipoSindicato.html(""),a.cargarNumeroNomina.html(""),o){case 1:$(".asimilados-icono").css("display",""),$(".asimilados-validacion").prop("required",!0),$(".asimilados-validacion").each(function(){$(this).hasClass("monetario")&&$(this).attr("pattern","[0-9,.]{4,}")});break;case 2:$(".mixto-icono").css("display",""),$(".mixto-validacion").prop("required",!0),$(".mixto-validacion").each(function(){$(this).hasClass("monetario")&&$(this).attr("pattern","[0-9,.]{4,}")});break;case 3:$(".sindicato-icono").css("display",""),$(".sindicato-validacion").prop("required",!0),$(".sindicato-validacion").each(function(){$(this).hasClass("monetario")&&$(this).attr("pattern","[0-9,.]{4,}")}),a.tipoSindicato.html('<div class="row form-group rowColorGray"><div class="col-md-12"><label for="">A.-Pagadora sindicato:</label> <i class="fa fa-check-circle text-green"></i><div class="input-group"><div class="input-group-addon"><i class="fa fa-list-ol"></i></div><select class="form-control textoMay iluminarIconoInput" name="tipoSindicato" required><option value=""></option><option value="1">SINDICATO ASESORES / CROM</option><option value="2">SINDICATO BUDAPEST</option></select></div> </div></div>');break;case 4:$(".sys-icono").css("display",""),$(".sys-validacion").prop("required",!0),$(".sys-validacion").each(function(){$(this).hasClass("monetario")&&$(this).attr("pattern","[0-9,.]{4,}")});break;case 5:$(".tarjeta-icono").css("display",""),$(".tarjeta-validacion").prop("required",!0),$(".tarjeta-validacion").each(function(){$(this).hasClass("monetario")&&$(this).attr("pattern","[0-9,.]{4,}")});break;case 6:$(".prestamo-icono").css("display",""),$(".prestamo-validacion").prop("required",!0),$(".prestamo-validacion").each(function(){$(this).hasClass("monetario")&&$(this).attr("pattern","[0-9,.]{4,}")});break;case 7:$(".especial-icono").css("display",""),$(".especial-validacion").prop("required",!0),$(".especial-validacion").each(function(){$(this).hasClass("monetario")&&$(this).attr("pattern","[0-9,.]{4,}")})}}static actualizarNominas(o=false){o?MetodosDiversos.crearRegistro("Hay nuevas nóminas registradas","¿ Deseas actualizar ahora ?",o=>{o&&("/asesores/nominas"===window.location.pathname?a.aceptarActualizar():location.href=ruta_server+"nominas")}):a.aceptarActualizar()}static aceptarActualizar(){a.recargarNominas.html('<div style="text-align:center"><i class="fa fa-spinner fa-pulse fa-fw" style="font-size:110px;"></i></div>'),MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{refrescarNominas:!0,location:window.location.pathname},(o,e)=>{o?console.log("Ocurrio un error: ",e):(a.recargarNominas.html(e.html),a.mostrarPaginador.html(e.paginador),a.totalTexto.html(e.total),a.filtroCliente.val(""),a.filtroFacturado.val(""),a.filtroNumeroNomina.val(""),a.filtroNominista.val(a.valorInicialNominista),"/asesores/finanzas"===window.location.pathname?a.filtroObservaciones.val(1):"/asesores/tesoreria"===window.location.pathname?a.filtroPago.val(1):"/asesores/nominas"===window.location.pathname?a.filtroAutorizacion.val(0):(a.filtroObservaciones.val(0),a.filtroPago.val(0),a.filtroAutorizacion.val("")),a.marcadorPendientes.text(e.pendientes),a.marcadorLiberadas.text(e.liberadas),a.marcadorCanceladas.text(e.canceladas),a.marcadorPendientes2.text(e.pendientes2),a.marcadorPagadas.text(e.pagadas),a.marcadorCanceladas2.text(e.canceladas2),a.setup(),a.botonMostrarData.click(function(){a.mostrarDatos($(this).attr("value"))}),a.paginador.click(function(o){a.paginar(o,$(this))}))})}static progressHandler(o){$("#loaded_n_total").text(a.formatBytes(o.loaded)+" de "+a.formatBytes(o.total));let e=o.loaded/o.total*100,n=Math.round(e);a.knobfunction(n)}static knobfunction(a){$("#progressBar").val(a).trigger("change")}static completeHandler(o){let e=JSON.parse(o.srcElement.response);e.error?(a.botonNominaPrimaria.attr("disabled",!1),MetodosDiversos.mostrarRespuesta("error",e.titulo,e.subtitulo,3e4,!0)):(a.setup(),a.actualizarNominas(),a.botonMostrarData.click(function(){a.mostrarDatos($(this).attr("value"))}),a.formulario[0].reset(),a.resetDocumentos2(),a.esquemas.val(""),a.formulario.css("visibility","hidden"),$("html,body").animate({scrollTop:$("#credencialesUsuario").offset().top},1e3),a.tipoSindicato.html(""),a.cargarNumeroNomina.html(""),a.totalAdjuntos.text(0),a.totalAdjuntosPeso.text("0 MB"),a.retencionTemporal=0,a.totalConRetencionTemporal=0,a.totalSinRetencionTemporal=0,MetodosDiversos.mostrarRespuesta("success",e.titulo,e.subtitulo,3e4,!0))}static errorHandler(){console.log("Algo fallo")}static abortHandler(){console.log("Se aborto")}static enviarFormulario(o){swal({title:'<input type="text" id="progressBar" value="0" data-width="120" data-height="120" data-fgColor="#f56954"><br><div class="knob-label" id="loaded_n_total"></div>',text:" Por favor espere... ",type:"",showConfirmButton:!1,allowOutsideClick:!1}),$("#progressBar").knob({change:function(a){}});let e=new XMLHttpRequest;e.upload.addEventListener("progress",a.progressHandler,!1),e.addEventListener("load",a.completeHandler,!1),e.addEventListener("error",a.errorHandler,!1),e.addEventListener("abort",a.abortHandler,!1),e.open("POST","controllers/AjaxNominas.php"),e.send(o)}static actualizarFormulario(o,e){swal({title:'<input type="text" id="progressBar" value="0" data-width="120" data-height="120" data-fgColor="#f56954"><br><div class="knob-label" id="loaded_n_total"></div>',text:" Por favor espere... ",type:"",showConfirmButton:!1,allowOutsideClick:!1}),$("#progressBar").knob({change:function(a){}});let n=new XMLHttpRequest;n.upload.addEventListener("progress",a.progressHandler,!1),n.addEventListener("load",function(o){let n=JSON.parse(o.srcElement.response);n.error?MetodosDiversos.mostrarRespuesta("error",n.titulo,n.subtitulo,3e4,!0):(MetodosDiversos.mostrarRespuesta("success",n.titulo,n.subtitulo,3e4,!0),168!=$("#credencialesUsuario").attr("value")&&172!=$("#credencialesUsuario").attr("value")&&a.actualizarNominas()),e(n.error)},!1),n.addEventListener("error",a.errorHandler,!1),n.addEventListener("abort",a.abortHandler,!1),n.open("POST","controllers/AjaxNominas.php"),n.send(o)}static mostrarDatos(o){let e=window.location.pathname,n={folioNomina:o,url:e};MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",n,(e,n)=>{if(e)console.log("Ocurrio un error: ",n);else{if(a.modalData.html(n.html),a.consecutivoNomina.text(o),a.setup(),"/asesores/nominas"===window.location.pathname){let o=a.subtotalAjax.val();a.retencionTemporalAjax=a.mascaraMoneda(a.convertirDecimal(o),.06),a.totalConRetencionTemporalAjax=a.mascaraMoneda(a.convertirDecimal(o),1.1),a.totalSinRetencionTemporalAjax=a.mascaraMoneda(a.convertirDecimal(o),1.16)}a.botonDocumentosNominas2.hide(),a.documentosNominas2.on("click",".attachTickets2",function(){a.botonDocumentosNominas2.click()}),a.ocultarLienzoAdjuntos.hide(),a.documentosNominas2.on("dragover",function(a){a.preventDefault(),a.stopPropagation(),'<h2>Arrastra y suelta los archivos que desees adjuntar o <button type="button" class="btn btn-default attachTickets2"><i class="fa fa-paperclip"></i> Presiona</button></h2>'===$(this).html()&&($(this).html(""),$(this).css({"padding-left":"30px","padding-right":"30px"})),$(this).css({background:"#007BFF",opacity:".6"})}),a.documentosNominas2.on("drop",function(o){o.preventDefault(),o.stopPropagation();let e=o.originalEvent.dataTransfer.files;a.cargarDocumentos2(e)}),a.documentosNominas2.on("dragleave",function(o){a.resetDocumentos2a()}),a.botonDocumentosNominas2.change(function(o){let e=o.target.files;'<h2>Arrastra y suelta los archivos que desees adjuntar o <button type="button" class="btn btn-default attachTickets2"><i class="fa fa-paperclip"></i> Presiona</button></h2>'===a.documentosNominas2.html()&&(a.documentosNominas2.html(""),a.documentosNominas2.css({"padding-left":"30px","padding-right":"30px"})),a.cargarDocumentos2(e),a.botonDocumentosNominas2.val("")}),a.documentosNominas2.on("click",".cancelDocument2",function(){let o,e=$(this).parent().children("span").text(),n=e.length;e=e.substring(0,n-17),o=a.files2.filter(function(a){return a.name===e})[0],void 0===o&&(e=e.substring(0,n-18),o=a.files2.filter(function(a){return a.name===e})[0]),a.files2=a.files2.filter(function(a){return a.name!=e}),$(this).parent().remove(),a.totalArchivos2>1?(a.totalArchivos2--,a.totalAdjuntos2.text(a.totalArchivos2),a.totalAdjuntosPeso2.text(a.convertirAmegas(a.totalArchivosAll2-=o.size))):(a.resetDocumentos2b(),a.totalAdjuntos2.text(a.totalArchivos2),a.totalAdjuntosPeso2.text("0 MB"))}),a.campoActualizar.prop("disabled",!0),a.campoActualizar2.prop("disabled",!0),a.campoActualizar3.prop("disabled",!0),a.botonFormularioGuardarNominas.hide(),a.botonFormularioGuardarTesoreria.hide(),a.botonFormularioGuardarFinanzas.hide(),a.botonFormularioActualizarNominas.click(function(){a.botonFormularioActualizarNominas.hide(),a.botonFormularioGuardarNominas.show(),a.campoActualizar.prop("disabled",!1),a.ocultarLienzoAdjuntos.show(),a.ocultarLienzoAdjuntos2.hide(),a.devengadaAjax.prop("checked")&&a.calcularRetencionIvaAjax.prop("disabled",!0)}),a.sinFactura.change(function(){65==$(this).val()&&"PRESTAMO"!=a.esquemasAjax.attr("value")?($(".sin-factura-icono").css("display","none"),$(".sin-factura").prop("required",!1)):"PRESTAMO"!=a.esquemasAjax.attr("value")&&($(".sin-factura-icono").css("display",""),$(".sin-factura").prop("required",!0))}),a.devengadaAjax.change(function(){$(this).prop("checked")?(a.ivaAjax.val(""),a.totalAjax.val(""),a.retencionIva6Ajax.val(""),a.calcularRetencionIvaAjax.prop("checked",!1),a.calcularRetencionIvaAjax.prop("disabled",!0),a.facturaDevengadaAjax.prop("disabled",!1),a.facturaDevengadaAjax.prop("required",!0),a.styleFacturaDevengadaAjax.css("display","")):(a.ivaAjax.val(a.mascaraMoneda(a.convertirDecimal(a.subtotalAjax.val()),.16)),a.totalAjax.val(a.mascaraMoneda(a.convertirDecimal(a.subtotalAjax.val()),1.16)),a.facturaDevengadaAjax.prop("disabled",!0),a.facturaDevengadaAjax.prop("required",!1),a.calcularRetencionIvaAjax.prop("disabled",!1),a.styleFacturaDevengadaAjax.css("display","none"),a.facturaDevengadaAjax.val(""))}),a.subtotalAjax.on("input",function(){a.calcularSubtotal2()}),a.retencionIsnAjax.on("input",function(){a.calcularSubtotal2()}),a.botonFormularioActualizarTesoreria.click(function(){a.botonFormularioActualizarTesoreria.hide(),a.botonFormularioGuardarTesoreria.show(),a.campoActualizar3.prop("disabled",!1),a.ocultarLienzoAdjuntos.show(),a.ocultarLienzoAdjuntos2.hide()}),a.botonFormularioActualizarFinanzas.click(function(){a.botonFormularioActualizarFinanzas.hide(),a.botonFormularioGuardarFinanzas.show(),a.campoActualizar2.prop("disabled",!1),a.ocultarLienzoAdjuntos.show(),a.ocultarLienzoAdjuntos2.hide()}),a.formularioActualizarNominas.submit(function(e){if(e.preventDefault(),a.checkRetencionIsnAjax.prop("checked")&&!a.calcularRetencionIvaAjax.prop("checked"))return void MetodosDiversos.mostrarRespuesta("info","Recuerda que toda nómina con retención de ISN debe tener retención de IVA","Selecciona el calculo automático del campo No. 7.-retención IVA",6e4,!0);let n=new FormData(a.formularioActualizarNominas[0]);n.append("actualizarNomina",o);let t=a.files2.length;if(t>0){for(let o=0;o<t;o++)n.append("files"+o,a.files2[o]);n.append("totalFile",t)}n.append("url",window.location.pathname),a.devengadaAjax.prop("checked")&&n.append("devengada",a.devengadaAjax.val()),a.actualizarFormulario(n,function(e){e||(a.botonFormularioActualizarNominas.show(),a.botonFormularioGuardarNominas.hide(),a.campoActualizar.prop("disabled",!0),a.ocultarLienzoAdjuntos.hide(),a.ocultarLienzoAdjuntos2.show(),a.resetDocumentos2b(),a.totalAdjuntos2.text(0),a.totalAdjuntosPeso2.text("0 MB"),t>0&&MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{archivosNominas:o,nominista:a.nominista},(e,n)=>{e||(a.labelAdjuntos.text(n.total),a.areaAdjuntosLoad.html(n.archivos),$(".botonArchivosAdjuntos").click(function(){a.botonArchivosAdjuntos2(o,$(this).attr("location"))}))}))})}),a.formularioActualizarTesoreria.submit(function(e){MetodosDiversos.mostrarRespuesta("",'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>',"Por favor espera...",6e4,!1),e.preventDefault();let n=new FormData(a.formularioActualizarTesoreria[0]);n.append("actualizarTesoreria",o);let t=a.files2.length;if(t>0){for(let o=0;o<t;o++)n.append("files"+o,a.files2[o]);n.append("totalFile",t)}n.append("url",window.location.pathname),a.actualizarFormulario(n,function(e){e||(a.botonFormularioActualizarTesoreria.show(),a.botonFormularioGuardarTesoreria.hide(),a.campoActualizar3.prop("disabled",!0),a.ocultarLienzoAdjuntos.hide(),a.ocultarLienzoAdjuntos2.show(),a.resetDocumentos2b(),MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{idNominaTesoreria:o},(o,e)=>{o||a.recargarTesoreriaComentarios.html(e.html)}),t>0&&MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{archivosTesoreria:o,nominista:a.nominista},(e,n)=>{e||(a.labelAdjuntos.text(n.total),a.areaAdjuntosLoad.html(n.archivos),$(".botonArchivosAdjuntos").click(function(){a.botonArchivosAdjuntos2(o,$(this).attr("location"))}))}))})}),a.formularioActualizarFinanzas.submit(function(e){e.preventDefault();let n=new FormData(a.formularioActualizarFinanzas[0]);n.append("actualizarFinanzas",o),a.financiada.prop("checked")&&n.append("finanzasFinanciada",a.financiada.val()),a.fondeoImss.prop("checked")&&n.append("finanzasFondeoImss",a.fondeoImss.val()),a.fondeoAsimilado.prop("checked")&&n.append("finanzasFondeoAsimilados",a.fondeoAsimilado.val());let t=a.files2.length;if(t>0){for(let o=0;o<t;o++)n.append("files"+o,a.files2[o]);n.append("totalFile",t)}n.append("url",window.location.pathname),a.actualizarFormulario(n,function(e){e||(a.botonFormularioActualizarFinanzas.show(),a.botonFormularioGuardarFinanzas.hide(),a.campoActualizar2.prop("disabled",!0),a.ocultarLienzoAdjuntos.hide(),a.ocultarLienzoAdjuntos2.show(),a.resetDocumentos2b(),MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{idNominaFinanzas:o},(o,e)=>{o||a.recargarFinanzasComentarios.html(e.html)}),t>0&&MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{archivosFinanzas:o,nominista:a.nominista},(e,n)=>{e||(a.labelAdjuntos.text(n.total),a.areaAdjuntosLoad.html(n.archivos),$(".botonArchivosAdjuntos").click(function(){a.botonArchivosAdjuntos2(o,$(this).attr("location"))}))}))})}),$("#contenedorPrincipalNominas").on("click",".eliminarAdjuntoNominas",function(){MetodosDiversos.crearRegistro('<i class="fa fa-trash text-red fa-3x fa-fw"></i>',`¿ Estas seguro que deseas ELIMINAR el archivo ?`,e=>{e&&(console.log(`Archivo: ${$(this).attr("name")} carpeta: ${o}`),MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{eliminarArchivo:$(this).attr("name"),rutaCarpeta:o},(o,e)=>{o?MetodosDiversos.mostrarRespuesta("error",e.titulo,e.subtitulo,3e4,!0):($(this).parent().parent().parent().remove(),0==$(".adjuntosContador").toArray().length&&a.labelAdjuntos.text(""))}))},!1)}),a.botonArchivosAdjuntos.click(function(){a.botonArchivosAdjuntos2(o,$(this).attr("location"))}),a.nominasPensionAlimenticia2.on("input",function(){a.calcularDescuentosSys2()}),a.nominasPrestamosEmpleados2.on("input",function(){a.calcularDescuentosSys2()}),a.nominasExcedentePensionAlimencia2.on("input",function(){a.calcularDescuentosTerceros2()}),a.nominasExcedenteClientes2.on("input",function(){a.calcularDescuentosTerceros2()}),a.nominasExcedenteOtros2.on("input",function(){a.calcularDescuentosTerceros2()}),a.nominasExcedenteIsr2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedenteImss2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedenteGmm2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedenteInfonavit2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedenteFonacot2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedentePrestamos2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedenteRecuperacion2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedenteComisionSocio2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedentePrenominaImss2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedentePrenominaGmm2.on("input",function(){a.calcularDescuentosAsesores2()}),a.nominasExcedenteCajaAhorro2.on("input",function(){a.calcularDescuentosAsesores2()}),a.calcularRetencionIvaAjax.change(function(){$(this).prop("checked")?(a.retencionIva6Ajax.val(0==a.retencionTemporalAjax?"":a.retencionTemporalAjax),a.totalAjax.val(0==a.totalConRetencionTemporalAjax?"":a.totalConRetencionTemporalAjax)):(a.retencionIva6Ajax.val(""),a.totalAjax.val(0==a.totalSinRetencionTemporalAjax?"":a.totalSinRetencionTemporalAjax)),a.calcularIsn2()}),a.checkRetencionIsnAjax.change(function(){$(this).prop("checked")?(a.retencionIsnAjax.val(a.impuestoEstatalAjax.val()),a.impuestoEstatalAjax.attr("required",!0),a.campoRetencionObligatorioAjax.css("display","")):(a.retencionIsnAjax.val(""),a.impuestoEstatalAjax.attr("required",!1),a.campoRetencionObligatorioAjax.css("display","none")),a.calcularSubtotal2()}),a.impuestoEstatalAjax.on("input",function(){if(a.checkRetencionIsnAjax.prop("checked")){let o=parseFloat(a.convertirDecimal(a.impuestoEstatalAjax.val()));a.retencionIsnAjax.val(a.mascaraMoneda(o,1)),a.calcularSubtotal2()}})}})}static botonArchivosAdjuntos2(o,e){a.modalArchivosAdjuntos.modal("show"),MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{archivosAdjuntos:o,location:e},(o,e)=>{o?MetodosDiversos.mostrarRespuesta("error",e.titulo,e.subtitulo,3e4,!0):(a.dataArchivosAdjuntos.html(e.html),a.labelArchivosAdjuntos.text(e.total))})}static paginar(o,e){o.preventDefault(),a.recargarNominas.html('<div style="text-align:center"><i class="fa fa-spinner fa-pulse fa-fw" style="font-size:110px;"></i></div>');let n=new FormData;n.append("paginaActual",$(e).parent().attr("actual")),n.append("registrosPorPagina",$(e).parent().parent().attr("registros")),n.append("target",$(e).parent().parent().attr("target")),n.append("cliente",$(e).parent().parent().attr("cliente")),n.append("nomina",$(e).parent().parent().attr("nomina")),n.append("facturado",$(e).parent().parent().attr("facturado")),n.append("liberado",$(e).parent().parent().attr("liberado")),n.append("pago",$(e).parent().parent().attr("pago")),n.append("url",window.location.pathname),n.append("nominista",$(e).parent().parent().attr("nominista")),n.append("autorizacion",$(e).parent().parent().attr("autorizacion")),MetodosDiversos.consultaAjaxFormulario("controllers/AjaxNominas.php",n,(o,e)=>{o?console.log("error",o):(a.recargarNominas.html(e.html),a.mostrarPaginador.html(e.paginador),a.totalTexto.html(e.total),a.setup(),a.paginador.click(function(o){a.paginar(o,$(this))}),a.botonMostrarData.click(function(){a.mostrarDatos($(this).attr("value"))}))})}static socketsNuevasNominas(){a.actualizarNominas(!0)}static filtros(){a.recargarNominas.html('<div style="text-align:center"><i class="fa fa-spinner fa-pulse fa-fw" style="font-size:110px;"></i></div>');let o=new FormData;o.append("paginaActual",1),o.append("registrosPorPagina",a.mostrarPaginador.find("ul").attr("registros")),o.append("target",a.mostrarPaginador.find("ul").attr("target")),o.append("cliente",a.filtroCliente.val()),o.append("facturado",a.facturado),o.append("liberado",a.filtroObservaciones.val()),o.append("pago",a.filtroPago.val()),o.append("nomina",a.filtroNumeroNomina.val()),o.append("url",window.location.pathname),o.append("nominista",a.filtroNominista.val()),o.append("autorizacion",a.filtroAutorizacion.val()),MetodosDiversos.consultaAjaxFormulario("controllers/AjaxNominas.php",o,(o,e)=>{o?console.log("error",o):(a.recargarNominas.html(e.html),a.mostrarPaginador.html(e.paginador),a.totalTexto.html(e.total),a.setup(),a.paginador.click(function(o){a.paginar(o,this)}),a.botonMostrarData.click(function(){a.mostrarDatos($(this).attr("value"))}))})}static cargaManual(o){MetodosDiversos.consultaAjaxFormulario("controllers/AjaxNominas.php",o,(o,e)=>{o?MetodosDiversos.mostrarRespuesta("error",e.titulo,e.subtitulo,3e4,!0):e.alerta?(MetodosDiversos.mostrarRespuesta("warning",e.titulo,e.subtitulo,3e4,!0),a.actualizarNominas()):(MetodosDiversos.mostrarRespuesta("success",e.titulo,e.subtitulo,3e4,!0),a.actualizarNominas()),a.cargarNominas.val(""),e.log&&a.log(e.dataLog)})}static log(o){let e=o,n=new Blob([e],{type:"text/plain;charset=utf-8"}),t=document.createElement("a");t.download="resultados.txt",window.URL=window.URL||window.webkitURL,t.href=window.URL.createObjectURL(n),t.onclick=a.destroyClickedElement,document.body.appendChild(t),t.click()}static destroyClickedElement(a){document.body.removeChild(a.target),console.log("eliminado")}static convertirDecimal(a){return""==a?0:(a=a.replace(/,/g,""),a=a.replace(".",""),a=a.substring(0,a.length-2)+"."+a.substring(a.length-2,a.length))}static mascaraMoneda(a,o){if(null!=a){let e=$(document.createElement("input"));return e.val((a*o).toFixed(2)),e.mask("000,000,000.00",{reverse:!0}),e.val()}}static obtenerPorcentaje(o){MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{obtenerPorcentaje:o},(o,e)=>{o?console.log("Ocurrio un error: ",e):(a.nominasComision.val(e.comision),a.comisionMonto=e.comision,a.campoComisionMonto.val(a.mascaraMoneda(a.convertirDecimal(a.subtotal.val()),parseFloat(a.comisionMonto/100))))})}static obtenerPorcentajeAjax(o){
    MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{obtenerPorcentaje:o},(o,e)=>{o?console.log("Ocurrio un error: ",e):(a.nominasComisionAjax.val(e.comision),a.comisionMontoAjax=e.comision,a.campoComisionMontoAjax.val(a.mascaraMoneda(a.convertirDecimal(a.subtotalAjax.val()),parseFloat(a.comisionMontoAjax/100))))})}static cargarDocumentos(o){a.documentosNominas.css({opacity:"1"});for(let e=0;e<o.length;e++){let n=o[e],t=!1;if(a.files.filter(function(a){if(a.name==n.name)return t=!0,a})[0],!t){let o=/\.(?=pdf)/gi.test(n.name);if("xml"===n.name.split(".").pop())return MetodosDiversos.mostrarRespuesta("error","Sólo puedes cargar archivos pdf","recuerda que los xml se cargan en los recibos de nómina, los comprobantes bancarios del cliente deben estar conformados exclusivamente por archivos pdf",3e4,!0),void a.reloadContadores();if(!o)return MetodosDiversos.mostrarRespuesta("error","Formato de archivo no valido","Sólo puedes cargar archivos pdf",3e4,!0),void a.reloadContadores();if(n.size>1024*a.fileSizeLimit*1024)return MetodosDiversos.mostrarRespuesta("error","Excediste el máximo permitido de MB por archivo","El tamaño máximo permito por cada archivo pdf es de 25 MB)",3e4,!0),void a.reloadContadores();if(a.totalArchivosAll+n.size>a.totalMaximo)return MetodosDiversos.mostrarRespuesta("error","Excediste el máximo total permitido de MB","El máximo permitido es de 50 MB por carga, para continuar con el proceso deberas eliminar archivos, recuerda que puedes anexar los que te falten posteriormente",3e4,!0),void a.reloadContadores();a.documentosNominas.append("<li><span>"+n.name+'</span><span class="close2 cancelDocument" aria-hidden="true" style="margin-right:2px;"><i class="fa fa-times fa-lg" style="color:#fff;" aria-hidden="true"></i></span><span style="color:#fff;margin-right:40px;float:right;font-weight: 700;"> Tamaño: '+a.convertirAmegas(n.size)+" </span></li>"),a.totalArchivosAll+=n.size,++a.totalArchivos,a.files.push(n)}}a.reloadContadores()}static reloadContadores(){a.totalAdjuntos.text(a.totalArchivos),a.totalAdjuntosPeso.text(a.convertirAmegas(a.totalArchivosAll)),a.resetDocumentos()}static formatBytes(a,o=2){if(0===a)return"0 Bytes";const e=1024,n=o<0?0:o,t=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,i)).toFixed(n))+" "+t[i]}static convertirAmegas(a){return(a/1024/1024).toFixed(2)+" MB"}static cargarDocumentos2(o){a.documentosNominas2.css({opacity:"1"});for(let e=0;e<o.length;e++){let n=o[e],t=!1;if(a.files2.filter(function(a){if(a.name==n.name)return t=!0,a})[0],!t){let o=/\.(?=pdf)/gi.test(n.name);if("xml"===n.name.split(".").pop())return void MetodosDiversos.mostrarRespuesta("error","Sólo puedes cargar archivos pdf","recuerda que los xml se cargan en los recibos de nómina, los comprobantes bancarios del cliente deben estar conformados exclusivamente por archivos pdf",3e4,!0);if(!o)return MetodosDiversos.mostrarRespuesta("error","Formato de archivo no valido","Sólo puedes cargar archivos pdf",3e4,!0),void a.reloadContadores();if(n.size>1024*a.fileSizeLimit*1024)return MetodosDiversos.mostrarRespuesta("error","Excediste el máximo permitido de MB por archivo","El tamaño máximo permito por cada archivo pdf es de 25 MB)",3e4,!0),void a.reloadContadores();if(a.totalArchivosAll2+n.size>a.totalMaximo)return MetodosDiversos.mostrarRespuesta("error","Excediste el máximo total permitido de MB","El máximo permitido es de 50 MB por carga, para continuar con el proceso deberas eliminar archivos, recuerda que puedes anexar los que te falten posteriormente",3e4,!0),void a.reloadContadores();a.documentosNominas2.append("<li><span>"+n.name+'</span><span class="close2 cancelDocument2" aria-hidden="true" style="margin-right:2px;"><i class="fa fa-times fa-lg" style="color:#fff;" aria-hidden="true"></i></span><span style="color:#fff;margin-right:40px;float:right;font-weight: 700;"> Tamaño: '+a.convertirAmegas(n.size)+" </span></li>"),a.totalArchivosAll2+=n.size,++a.totalArchivos2,a.files2.push(n)}}a.reloadContadores2()}static reloadContadores2(){a.totalAdjuntos2.text(a.totalArchivos2),a.totalAdjuntosPeso2.text(a.convertirAmegas(a.totalArchivosAll2)),a.resetDocumentos2a()}static resetDocumentos(){""===a.documentosNominas.html()?(a.documentosNominas.html('<h2>Arrastra y suelta los archivos que desees adjuntar o <button type="button" class="btn btn-default attachTickets"><i class="fa fa-paperclip"></i> Presiona</button></h2>'),a.documentosNominas.css({"padding-left":"0","padding-right":"0"}),a.documentosNominas.css({opacity:"1"})):a.documentosNominas.css({opacity:"1"})}static resetDocumentos2a(){""===a.documentosNominas2.html()?(a.documentosNominas2.html('<h2>Arrastra y suelta los archivos que desees adjuntar o <button type="button" class="btn btn-default attachTickets2"><i class="fa fa-paperclip"></i> Presiona</button></h2>'),a.documentosNominas2.css({"padding-left":"0","padding-right":"0"}),a.documentosNominas2.css({opacity:"1"})):a.documentosNominas2.css({opacity:"1"})}static resetDocumentos2(){a.documentosNominas.html('<h2>Arrastra y suelta los archivos que desees adjuntar o <button type="button" class="btn btn-default attachTickets"><i class="fa fa-paperclip"></i> Presiona</button></h2>'),a.documentosNominas.css({"padding-left":"0","padding-right":"0"}),a.totalArchivos=0,a.totalArchivosAll=0,a.files=[],a.totalAdjuntos.text(0),a.totalAdjuntosPeso.text("0 MB")}static resetDocumentos2b(){a.documentosNominas2.html('<h2>Arrastra y suelta los archivos que desees adjuntar o <button type="button" class="btn btn-default attachTickets2"><i class="fa fa-paperclip"></i> Presiona</button></h2>'),a.documentosNominas2.css({"padding-left":"0","padding-right":"0"}),a.totalArchivos2=0,a.totalArchivosAll2=0,a.files2=[],a.totalAdjuntos2.text(0),a.totalAdjuntosPeso2.text("0 MB")}static eliminarRegistros(){let o=a.idAeliminar.length>1?"nóminas":"nómina";MetodosDiversos.crearRegistro('<i class="fa fa-trash text-red fa-3x fa-fw"></i>',`¿ Estas seguro que deseas ELIMINAR: ${a.idAeliminar.length} ${o} ?`,o=>{o&&MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{dataEliminar:JSON.stringify(a.idAeliminar)},(o,e)=>{o?console.log("Ocurrio un error: ",e):(a.actualizarNominas(),a.idAeliminar=[],a.eliminarMasivo.prop("checked",!1))})},!1)}static liberarRegistros(){let o=a.idLiberar.length>1?"nóminas":"nómina";MetodosDiversos.crearRegistro('<i class="fa fa-check-square-o text-green fa-3x fa-fw"></i>',`¿ Estas seguro que deseas AUTORIZAR: ${a.idLiberar.length} ${o} ?`,o=>{o&&MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{dataLiberar:JSON.stringify(a.idLiberar)},(o,e)=>{o?console.log("Ocurrio un error: ",e):(a.actualizarNominas(),a.idLiberar=[],a.autorizarMasivo.prop("checked",!1))})},!1)}static cargarMasivos(o){swal({title:'<input type="text" id="progressBar" value="0" data-width="120" data-height="120" data-fgColor="#f56954"><br><div class="knob-label" id="loaded_n_total"></div>',text:" Por favor espere... ",type:"",showConfirmButton:!1,allowOutsideClick:!1}),$("#progressBar").knob({change:function(a){}});let e=new XMLHttpRequest;e.upload.addEventListener("progress",a.progressHandler,!1),e.addEventListener("load",function(a){let o=a.loaded;if(0===parseInt(o))MetodosDiversos.mostrarRespuesta("error","Excediste el máximo total permitido de MB","El máximo permitido es de 50 MB por carga, para continuar con el proceso deberas eliminar archivos, recuerda que puedes anexar los que te falten posteriormente",3e4,!0);else{let o=JSON.parse(a.srcElement.response);MetodosDiversos.mostrarRespuesta("success",o.titulo,o.subtitulo,3e4,!0)}},!1),e.addEventListener("error",a.errorHandler,!1),e.addEventListener("abort",a.abortHandler,!1),e.open("POST","controllers/AjaxNominas.php"),e.send(o)}static verificarCargaNomina(){a.formulario.css("visibility","hidden"),swal({title:"Escibe el número de nómina vinculado a este proceso",text:"",input:"text",inputPlaceholder:""}).then(function(o){MetodosDiversos.consultaAjaxData("controllers/AjaxNominas.php",{idNominaCargar:o},(o,e)=>{o?MetodosDiversos.mostrarRespuesta("error","Ocurrio un error","contacta al administrador",6e4,!0):""==e.data?(MetodosDiversos.mostrarRespuesta("error","Verifica el número de nómina","El número de nómina no existe, la nómina no tiene el concepto pagada con observación (departamento de tesoreria) o no tienes permisos para esa nómina",6e4,!0),a.esquemas.val("")):(a.formulario.css("visibility",""),a.cargarData(e.data))})}).catch(function(){})}static cargarData(o){a.validacionCambioEsquemas(parseInt(o.esquema));let e="";1==o.esquema?e="ASIMILADOS":2==o.esquema?e="MIXTO":3==o.esquema?e="SINDICATOS":4==o.esquema?e="SUELDOS Y SALARIOS":5==o.esquema?e="TARJETA EMPRESARIAL":6==o.esquema?e="PRESTAMO":7==o.esquema&&(e="CONFIDENCIAL"),a.numeroNominaOrigen=o.id,a.cargarNumeroNomina.html('<div class="row" style="margin-bottom:10px;"><div class="col-md-6"><span><b>Número de nómina origen:</b> <span class="textoMay"><span style="font-size:15px;background:#00a65a;padding:5px;color:#fff;border-radius:5px;">'+o.id+' </span></span></span></div><div class="col-md-6"><span><b>Tipo de esquema de nómina origen:</b> <span class="textoMay"><span style="font-size:15px;background:#00a65a;padding:5px;color:#fff;border-radius:5px;">'+e+" </span></span></span></div></div>"),3==o.esquema&&(a.tipoSindicato.html('<div class="row form-group rowColorGray"><div class="col-md-12"><label for="">A.-Pagadora sindicato:</label> <i class="fa fa-check-circle text-green"></i><div class="input-group"><div class="input-group-addon"><i class="fa fa-list-ol"></i></div><select class="form-control textoMay iluminarIconoInput" name="tipoSindicato" required><option value=""></option><option value="1">SINDICATO ASESORES / CROM</option><option value="2">SINDICATO BUDAPEST</option></select></div> </div></div>'),$('select[name="tipoSindicato"]').val(o.tipo_sindicato)),parseInt(o.devengada)?a.devengada.prop("checked",!0):a.devengada.prop("checked",!1),a.nominasCliente.val(o.id_cliente),a.nominasTipoPago.val(o.tipo_pago),a.nominasRegimen.val(o.regimen),a.nominasComision.val(a.mascaraMoneda(o.comision_porcentaje,1)),a.nominasEmpresaFactura.val(o.empresa_facturadora),a.nominasSubtotal.val(a.mascaraMoneda(o.subtotal,1)),a.nominasIva.val(a.mascaraMoneda(o.iva,1)),a.nominasTotal.val(a.mascaraMoneda(o.total,1)),a.nominasEmpresaImss.val(o.empresa_imss),a.nominasTotalImss.val(a.mascaraMoneda(o.total_imss,1)),a.nominasEmpresaAsimilados.val(o.empresa_asimilados),a.nominasTotalAsimilados.val(a.mascaraMoneda(o.total_asimilados,1)),a.nominasPeriodo.val(o.tipo_periodo),a.nominasNumeroPeriodo.val(o.numero_periodo),a.nominasSocios.val(o.socios),a.nominasDescuentosSys.val(a.mascaraMoneda(o.descuentos_sys,1)),a.nominasDescuentosAsesores.val(a.mascaraMoneda(o.descuentos_asesores,1)),a.nominasDescuentosTerceros.val(a.mascaraMoneda(o.descuentos_terceros,1)),a.retencionIva.val(a.mascaraMoneda(o.retencion_iva,1)),a.nominasIngreso.val(a.mascaraMoneda(o.ingreso,1)),a.nominasInfonavit.val(a.mascaraMoneda(o.infonavit,1)),a.nominasFonacot.val(a.mascaraMoneda(o.fonacot,1)),a.nominasDonativo.val(a.mascaraMoneda(o.donativo,1)),a.nominasPensionAlimenticia.val(a.mascaraMoneda(o.pension,1)),a.nominasExcedenteCargas.val(a.mascaraMoneda(o.excedente_cargas,1)),a.nominasCargaPatronal.val(a.mascaraMoneda(o.cargas_patronal,1)),a.nominasIsn.val(a.mascaraMoneda(o.isn,1)),a.nominasComisionMonto.val(a.mascaraMoneda(o.comision_monto,1)),a.nominasImssObrera.val(a.mascaraMoneda(o.imss_obrera,1)),a.nominasCargaSocialImss.val(a.mascaraMoneda(o.carga_social_imss,1)),a.nominasPrenominaImss.val(a.mascaraMoneda(o.prenomina_imss,1)),a.nominasIsrIsp.val(a.mascaraMoneda(o.isr_isp,1)),a.nominasIsr142.val(a.mascaraMoneda(o.isr_142,1)),a.nominasCuotaSindical.val(a.mascaraMoneda(o.cuota_sindical,1)),a.nominasDespensa.val(a.mascaraMoneda(o.despensa,1)),a.nominasCajaAhorro.val(a.mascaraMoneda(o.caja_ahorro,1)),a.nominasDescuentoImss.val(a.mascaraMoneda(o.descuento_imss,1)),a.nominasApoyoSindical.val(a.mascaraMoneda(o.apoyo_sindical,1)),a.nominasDescuentoComedor.val(a.mascaraMoneda(o.descuento_comedor,1)),a.nominasHaberes.val(a.mascaraMoneda(o.haberes,1)),a.nominasExcedenteSubsidio.val(a.mascaraMoneda(o.excedente_subsidio,1)),a.nominasPrestamosEmpleados.val(a.mascaraMoneda(o.prestamos_empleados,1)),a.nominasPrestamosAyudate.val(a.mascaraMoneda(o.prestamos_ayudate,1)),a.nominasOtros.val(a.mascaraMoneda(o.otros,1)),a.nominasExcedenteIngreso.val(a.mascaraMoneda(o.excedente_ingreso,1)),a.nominasExcedenteTerceros.val(a.mascaraMoneda(o.excedente_terceros,1)),a.nominasExcedenteIsr.val(a.mascaraMoneda(o.excedente_isr,1)),a.nominasExcedenteImss.val(a.mascaraMoneda(o.excedente_imss,1)),a.nominasExcedenteGmm.val(a.mascaraMoneda(o.excedente_gmm,1)),a.nominasExcedenteInfonavit.val(a.mascaraMoneda(o.excedente_infonavit,1)),a.nominasExcedenteFonacot.val(a.mascaraMoneda(o.excedente_fonacot,1)),a.nominasExcedentePrestamos.val(a.mascaraMoneda(o.excedente_prestamos,1)),a.nominasExcedentePensionAlimencia.val(a.mascaraMoneda(o.excedente_pension,1)),a.nominasExcedenteIngresosSinTimbrar.val(a.mascaraMoneda(o.excedente_terceros,1)),a.nominasExcedenteClientes.val(a.mascaraMoneda(o.excedente_clientes,1)),a.nominasExcedenteRecuperacion.val(a.mascaraMoneda(o.excedente_recuperacion,1)),a.nominasExcedenteComisionSocio.val(a.mascaraMoneda(o.excedente_comision,1)),a.nominasExcedentePrenominaImss.val(a.mascaraMoneda(o.excedente_prenomina,1)),a.nominasExcedentePrenominaGmm.val(a.mascaraMoneda(o.excedente_prenomina_gmm,1)),a.nominasExcedenteCajaAhorro.val(a.mascaraMoneda(o.excedente_caja_ahorro,1)),a.nominasExcedenteOtros.val(a.mascaraMoneda(o.excedente_otros,1)),a.nominasComentarios.val(o.comentarios_nominas.replace(/<br \/>/gi,""));let n=o.subtotal;a.retencionTemporal=a.mascaraMoneda(a.convertirDecimal(n),.06),a.totalConRetencionTemporal=a.mascaraMoneda(a.convertirDecimal(n),1.1),a.totalSinRetencionTemporal=a.mascaraMoneda(a.convertirDecimal(n),1.16),null!=o.retencion_iva&&a.calcularRetencionIva.prop("checked",!0)}static calcularDescuentosSys(){let o=parseFloat(a.convertirDecimal(a.nominasPensionAlimenticia.val()))+parseFloat(a.convertirDecimal(a.nominasPrestamosEmpleados.val()));o>0?a.nominasDescuentosSys.val(a.mascaraMoneda(o,1)):a.nominasDescuentosSys.val("")}static calcularDescuentosSys2(){let o=parseFloat(a.convertirDecimal(a.nominasPensionAlimenticia2.val()))+parseFloat(a.convertirDecimal(a.nominasPrestamosEmpleados2.val()));o>0?a.nominasDescuentosSys2.val(a.mascaraMoneda(o,1)):a.nominasDescuentosSys2.val("")}static calcularDescuentosAsesores(){let o=parseFloat(a.convertirDecimal(a.nominasExcedenteIsr.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteImss.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteGmm.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteInfonavit.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteFonacot.val()))+parseFloat(a.convertirDecimal(a.nominasExcedentePrestamos.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteRecuperacion.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteComisionSocio.val()))+parseFloat(a.convertirDecimal(a.nominasExcedentePrenominaImss.val()))+parseFloat(a.convertirDecimal(a.nominasExcedentePrenominaGmm.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteCajaAhorro.val()));o>0?a.nominasDescuentosAsesores.val(a.mascaraMoneda(o,1)):a.nominasDescuentosAsesores.val("")}static calcularDescuentosAsesores2(){let o=parseFloat(a.convertirDecimal(a.nominasExcedenteIsr2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteImss2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteGmm2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteInfonavit2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteFonacot2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedentePrestamos2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteRecuperacion2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteComisionSocio2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedentePrenominaImss2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedentePrenominaGmm2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteCajaAhorro2.val()));o>0?a.nominasDescuentosAsesores2.val(a.mascaraMoneda(o,1)):a.nominasDescuentosAsesores2.val("")}static calcularDescuentosTerceros(){let o=parseFloat(a.convertirDecimal(a.nominasExcedentePensionAlimencia.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteClientes.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteOtros.val()));o>0?a.nominasDescuentosTerceros.val(a.mascaraMoneda(o,1)):a.nominasDescuentosTerceros.val("")}static calcularDescuentosTerceros2(){let o=parseFloat(a.convertirDecimal(a.nominasExcedentePensionAlimencia2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteClientes2.val()))+parseFloat(a.convertirDecimal(a.nominasExcedenteOtros2.val()));o>0?a.nominasDescuentosTerceros2.val(a.mascaraMoneda(o,1)):a.nominasDescuentosTerceros2.val("")}static calcularSubtotal(){if(!a.devengada.prop("checked")){let o=a.subtotal.val();""!=o?(a.iva.val(a.mascaraMoneda(a.convertirDecimal(o),.16)),a.retencionTemporal=a.mascaraMoneda(a.convertirDecimal(o),.06),a.totalConRetencionTemporal=a.mascaraMoneda(a.convertirDecimal(o),1.1),a.totalSinRetencionTemporal=a.mascaraMoneda(a.convertirDecimal(o),1.16),a.calcularRetencionIva.prop("checked")?(a.total.val(a.totalConRetencionTemporal),a.retencionIva6.val(a.retencionTemporal)):a.total.val(a.totalSinRetencionTemporal),a.calcularIsn()):(a.iva.val(""),a.total.val(""),a.retencionIva6.val(""),a.retencionTemporal=0,a.totalConRetencionTemporal=0,a.totalSinRetencionTemporal=0)}}static calcularSubtotal2(){if(!a.devengadaAjax.prop("checked")){let o=a.subtotalAjax.val();""!=o?(a.ivaAjax.val(a.mascaraMoneda(a.convertirDecimal(o),.16)),a.retencionTemporalAjax=a.mascaraMoneda(a.convertirDecimal(o),.06),a.totalConRetencionTemporalAjax=a.mascaraMoneda(a.convertirDecimal(o),1.1),a.totalSinRetencionTemporalAjax=a.mascaraMoneda(a.convertirDecimal(o),1.16),a.calcularRetencionIvaAjax.prop("checked")?(a.totalAjax.val(a.totalConRetencionTemporalAjax),a.retencionIva6Ajax.val(a.retencionTemporalAjax)):a.totalAjax.val(a.totalSinRetencionTemporalAjax),a.calcularIsn2()):(a.ivaAjax.val(""),a.totalAjax.val(""),a.retencionIva6Ajax.val(""),a.retencionTemporalAjax=0,a.totalConRetencionTemporalAjax=0,a.totalSinRetencionTemporalAjax=0)}}static calcularIsn(){let o=parseFloat(a.convertirDecimal(a.total.val()))-parseFloat(a.convertirDecimal(a.retencionIsn.val()));o>0?a.total.val(a.mascaraMoneda(o,1)):a.total.val("")}static calcularIsn2(){let o=parseFloat(a.convertirDecimal(a.totalAjax.val()))-parseFloat(a.convertirDecimal(a.retencionIsnAjax.val()));o>0?a.totalAjax.val(a.mascaraMoneda(o,1)):a.totalAjax.val("")}static main(){a.setup(),a.eliminarNominas=$("#eliminarNominas"),a.idAeliminar=Array(),a.liberarNominas=$("#liberarNominas"),a.idLiberar=Array(),a.totalMaximo=52428800,a.retencionTemporal=0,a.totalConRetencionTemporal=0,a.totalSinRetencionTemporal=0,a.campoRetencionObligatorio=$(".campoRetencionObligatorio"),a.valorInicialNominista=a.filtroNominista.val(),$("#contenedorPrincipalNominas").on("click",".visor-pdf-crow-nominas",function(){mostrarVisorCrowPdf($(this))}),"/asesores/finanzas"===window.location.pathname?a.filtroObservaciones.val(1):"/asesores/tesoreria"===window.location.pathname?a.filtroPago.val(1):"/asesores/nominas"===window.location.pathname&&a.filtroAutorizacion.val(0),a.formulario.css("visibility","hidden"),a.esquemas.change(function(){a.numeroNominaOrigen=null,a.botonNominaPrimaria.attr("disabled",!1),""!=$(this).val()&&8!=$(this).val()?(a.formulario.css("visibility",""),a.validacionCambioEsquemas(parseInt($(this).val()))):8==$(this).val()?a.verificarCargaNomina():a.formulario.css("visibility","hidden")}),a.paginador.click(function(o){a.paginar(o,this)}),a.formulario.submit(function(o){o.preventDefault();let e=new FormData(a.formulario[0]);e.append("tipoEsquema",a.esquemas.val()),a.devengada.prop("checked")&&e.append("devengada",a.devengada.val()),null!=a.numeroNominaOrigen&&e.append("nomina_origen",a.numeroNominaOrigen);let n=a.files.length;if(n>0){for(let o=0;o<n;o++)e.append("files"+o,a.files[o]);e.append("totalFile",n)}return e.append("url",window.location.pathname),a.checkRetencionIsn.prop("checked")&&!a.calcularRetencionIva.prop("checked")?void MetodosDiversos.mostrarRespuesta("info","Recuerda que toda nómina con retención de ISN debe tener retención de IVA","Selecciona el calculo automático del campo No. 7.-retención IVA",6e4,!0):(a.botonNominaPrimaria.attr("disabled",!0),void a.enviarFormulario(e))}),a.cancelar.click(function(){a.formulario[0].reset(),a.files=[],a.numeroNominaOrigen=null,a.resetDocumentos2(),a.cargarNumeroNomina.html(""),a.formulario.css("visibility","hidden"),a.esquemas.val(""),a.retencionTemporal=0,a.totalConRetencionTemporal=0,a.totalSinRetencionTemporal=0,$("html,body").animate({scrollTop:$("#credencialesUsuario").offset().top},300)}),a.subtotal.on("input",function(){a.calcularSubtotal()}),a.impuestoEstatal.on("input",function(){if(a.checkRetencionIsn.prop("checked")){let o=parseFloat(a.convertirDecimal(a.impuestoEstatal.val()));a.retencionIsn.val(a.mascaraMoneda(o,1)),a.calcularSubtotal()}}),a.checkRetencionIsn.change(function(){$(this).prop("checked")?(a.retencionIsn.val(a.impuestoEstatal.val()),a.campoRetencionObligatorio.css("display",""),a.impuestoEstatal.attr("required",!0)):(a.retencionIsn.val(""),a.campoRetencionObligatorio.css("display","none"),a.impuestoEstatal.attr("required",!1)),a.calcularSubtotal()}),a.botonMostrarData.click(function(){a.mostrarDatos($(this).attr("value"))}),a.botonActualizarNominas.click(function(){a.actualizarNominas()}),a.filtroCliente.change(function(){a.filtros()}),a.filtroNumeroNomina.on("input",function(){a.filtros()}),a.filtroFacturado.on("input",function(){$(this).val().length>1?a.facturado=a.convertirDecimal($(this).val()):a.facturado="",a.filtros()}),a.filtroObservaciones.change(function(){a.filtros()}),a.filtroPago.change(function(){a.filtros()}),a.filtroNominista.on("input",function(){a.filtros()}),a.filtroAutorizacion.change(function(){a.filtros()}),a.cargarNominas.change(function(o){swal({title:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>',text:" Por favor espere...",type:"",showConfirmButton:!1,allowOutsideClick:!1});let e=o.target.files[0],n=/\.(?=xlsx)/gi.test(e.name);if(!n)return a.cargarNominas.val(""),void swal("Formato no válido","Formatos válido: .xlsx","error").catch(swal.noop);let t=new FormData(a.formularioCargarNominasManual[0]);t.append("cargaManual",window.location.pathname),a.cargaManual(t)}),a.info.click(function(){swal($(this).parent().parent().children("label").text(),$(this).attr("info"),"info").catch(swal.noop)}),a.sinFactura.change(function(){65==$(this).val()&&parseInt(a.esquemas.val())<6?($(".sin-factura-icono").css("display","none"),$(".sin-factura").prop("required",!1)):parseInt(a.esquemas.val())<6&&($(".sin-factura-icono").css("display",""),$(".sin-factura").prop("required",!0))}),a.devengada.change(function(){$(this).prop("checked")?(a.iva.val(""),a.total.val(""),a.retencionIva6.val(""),a.calcularRetencionIva.prop("checked",!1),a.calcularRetencionIva.prop("disabled",!0),a.facturaDevengada.prop("disabled",!1),a.facturaDevengada.prop("required",!0),a.styleFacturaDevengada.css("display","")):(a.iva.val(a.mascaraMoneda(a.convertirDecimal(a.subtotal.val()),.16)),a.total.val(a.mascaraMoneda(a.convertirDecimal(a.subtotal.val()),1.16)),a.calcularRetencionIva.prop("disabled",!1),a.facturaDevengada.prop("disabled",!0),a.facturaDevengada.prop("required",!1),a.styleFacturaDevengada.css("display","none"),a.facturaDevengada.val(""))}),a.calcularRetencionIva.change(function(){$(this).prop("checked")?(a.retencionIva6.val(0==a.retencionTemporal?"":a.retencionTemporal),a.total.val(0==a.totalConRetencionTemporal?"":a.totalConRetencionTemporal)):(a.retencionIva6.val(""),a.total.val(0==a.totalSinRetencionTemporal?"":a.totalSinRetencionTemporal)),a.calcularIsn()}),$("body").on("dragover",function(a){a.preventDefault(),a.stopPropagation()}),$("body").on("drop",function(a){a.preventDefault(),a.stopPropagation()}),a.botonDocumentosNominas.hide(),a.documentosNominas.on("click",".attachTickets",function(){a.botonDocumentosNominas.click()}),a.documentosNominas.on("dragover",function(a){a.preventDefault(),a.stopPropagation(),'<h2>Arrastra y suelta los archivos que desees adjuntar o <button type="button" class="btn btn-default attachTickets"><i class="fa fa-paperclip"></i> Presiona</button></h2>'===$(this).html()&&($(this).html(""),$(this).css({"padding-left":"30px","padding-right":"30px"})),$(this).css({background:"#007BFF",opacity:".6"})}),a.documentosNominas.on("drop",function(o){o.preventDefault(),o.stopPropagation();let e=o.originalEvent.dataTransfer.files;a.cargarDocumentos(e)}),a.documentosNominas.on("dragleave",function(o){a.resetDocumentos()}),a.botonDocumentosNominas.change(function(o){let e=o.target.files;'<h2>Arrastra y suelta los archivos que desees adjuntar o <button type="button" class="btn btn-default attachTickets"><i class="fa fa-paperclip"></i> Presiona</button></h2>'===a.documentosNominas.html()&&(a.documentosNominas.html(""),a.documentosNominas.css({"padding-left":"30px","padding-right":"30px"})),a.cargarDocumentos(e),a.botonDocumentosNominas.val("")}),a.documentosNominas.on("click",".cancelDocument",function(){let o,e=$(this).parent().children("span").text(),n=e.length;e=e.substring(0,n-17),o=a.files.filter(function(a){return a.name===e})[0],void 0===o&&(e=e.substring(0,n-18),o=a.files.filter(function(a){return a.name===e})[0]),a.files=a.files.filter(function(a){return a.name!==e}),$(this).parent().remove(),a.totalArchivos>1?(a.totalArchivos--,a.totalAdjuntos.text(a.totalArchivos),a.totalAdjuntosPeso.text(a.convertirAmegas(a.totalArchivosAll-=o.size))):(a.resetDocumentos2(),a.totalAdjuntos.text(0),a.totalAdjuntosPeso.text("0 MB"))}),a.recargarNominas.on("click",".grupoCheckedNominas",function(){let o=parseInt($(this).parent().parent().siblings("span").text());$(this).prop("checked")?a.idAeliminar.push(o):a.idAeliminar=a.idAeliminar.filter(function(a){return a!=o})}),a.eliminarNominas.click(function(){let o=a.idAeliminar.length;o<1?swal('<i class="fa fa-trash text-red fa-3x fa-fw"></i>',"Selecciona las nóminas a eliminar (sólo puedes seleccionar las que tú registraste o las de tu personal a cargo).","").catch(swal.noop):a.eliminarRegistros()}),a.recargarNominas.on("click",".grupoCheckedNominas2",function(){let o=parseInt($(this).parent().parent().siblings("span").text());$(this).prop("checked")?a.idLiberar.push(o):a.idLiberar=a.idLiberar.filter(function(a){return a!=o})}),a.liberarNominas.click(function(){let o=a.idLiberar.length;o<1?swal('<i class="fa fa-check-square-o text-green fa-3x fa-fw"></i>',"Selecciona las nóminas a autorizar (sólo puedes seleccionar las que tú registraste o las de tu personal a cargo).","").catch(swal.noop):a.liberarRegistros()}),a.adjuntarArchivosMasivos.change(function(o){let e=new FormData,n=o.target.files,t=n.length,i=0;if(t>0){for(let o=0;o<t;o++)e.append("files"+o,n[o]),i+=n[o].size,e.append("ruta"+o,n[o].webkitRelativePath);e.append("totalArchivosMasivos",t),e.append("ruta",window.location.pathname),a.adjuntarArchivosMasivos.val(""),a.cargarMasivos(e)}}),a.adjuntarArchivosMasivosFinanzas.change(function(o){let e=new FormData,n=o.target.files,t=n.length,i=0;if(t>0){for(let o=0;o<t;o++)e.append("files"+o,n[o]),i+=n[o].size,e.append("ruta"+o,n[o].webkitRelativePath);if(e.append("totalArchivosMasivos",t),e.append("ruta",window.location.pathname),a.adjuntarArchivosMasivos.val(""),i>a.totalMaximo)return void MetodosDiversos.mostrarRespuesta("error","Excediste el máximo total permitido de MB","El máximo permitido es de 50 MB por carga, para continuar con el proceso deberas eliminar archivos, recuerda que puedes anexar los que te falten posteriormente",3e4,!0);a.cargarMasivos(e)}}),a.adjuntarArchivosMasivosTesoreria.change(function(o){let e=new FormData,n=o.target.files,t=n.length,i=0;if(t>0){for(let o=0;o<t;o++)e.append("files"+o,n[o]),i+=n[o].size,e.append("ruta"+o,n[o].webkitRelativePath);if(e.append("totalArchivosMasivos",t),e.append("ruta",window.location.pathname),a.adjuntarArchivosMasivos.val(""),i>a.totalMaximo)return void MetodosDiversos.mostrarRespuesta("error","Excediste el máximo total permitido de MB","El máximo permitido es de 50 MB por carga, para continuar con el proceso deberas eliminar archivos, recuerda que puedes anexar los que te falten posteriormente",3e4,!0);a.cargarMasivos(e)}}),a.adjuntarArchivosMasivosRecibos.change(function(o){let e=new FormData,n=o.target.files,t=n.length,i=0;if(t>0){for(let o=0;o<t;o++)e.append("files"+o,n[o]),i+=n[o].size,e.append("ruta"+o,n[o].webkitRelativePath);if(e.append("totalArchivosMasivos",t),e.append("ruta",window.location.pathname+2),a.adjuntarArchivosMasivosRecibos.val(""),i>a.totalMaximo)return void MetodosDiversos.mostrarRespuesta("error","Excediste el máximo total permitido de MB","El máximo permitido es de 50 MB por carga, para continuar con el proceso deberas eliminar archivos, recuerda que puedes anexar los que te falten posteriormente",3e4,!0);a.cargarMasivos(e)}}),a.nominasPensionAlimenticia.on("input",function(){a.calcularDescuentosSys()}),a.nominasPrestamosEmpleados.on("input",function(){a.calcularDescuentosSys()}),a.nominasExcedenteIsr.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedenteImss.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedenteGmm.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedenteInfonavit.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedenteFonacot.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedentePrestamos.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedenteRecuperacion.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedenteComisionSocio.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedentePrenominaImss.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedentePrenominaGmm.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedenteCajaAhorro.on("input",function(){a.calcularDescuentosAsesores()}),a.nominasExcedentePensionAlimencia.on("input",function(){a.calcularDescuentosTerceros()}),a.nominasExcedenteClientes.on("input",function(){a.calcularDescuentosTerceros()}),a.nominasExcedenteOtros.on("input",function(){a.calcularDescuentosTerceros()}),a.autorizarMasivo.click(function(){$(this).prop("checked")?($(".grupoCheckedNominas2").prop("checked",$(this).prop("checked")),a.idLiberar=Array(),$(".grupoCheckedNominas2").each(function(){let o=parseInt($(this).parent().parent().siblings("span").text());a.idLiberar.push(o)})):($(".grupoCheckedNominas2").prop("checked",$(this).prop("checked")),a.idLiberar=Array())}),a.eliminarMasivo.click(function(){$(this).prop("checked")?($(".grupoCheckedNominas").prop("checked",$(this).prop("checked")),a.idAeliminar=Array(),$(".grupoCheckedNominas").each(function(){let o=parseInt($(this).parent().parent().siblings("span").text());a.idAeliminar.push(o)})):($(".grupoCheckedNominas").prop("checked",$(this).prop("checked")),a.idAeliminar=Array())})}}a.main();